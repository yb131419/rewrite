<!-- index.html -->
<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body { font-family: 'Segoe UI', sans-serif; padding: 20px; }
      .card { border: 1px solid #ccc; border-radius: 10px; padding: 20px; margin-bottom: 20px; background-color: #f9f9f9; }
      textarea { width: 100%; height: 120px; padding: 10px; border-radius: 6px; border: 1px solid #ddd; }
      select, button { padding: 8px; font-size: 14px; border-radius: 5px; margin-top: 10px; }
      pre { background: #efefef; padding: 10px; border-radius: 6px; white-space: pre-wrap; }
    </style>
  </head>
  <body>
    <div class="card">
      <h2>📘 貼上文章自動改寫</h2>
      <textarea id="originalText" placeholder="請貼上原始文章..."></textarea><br><br>

      <label>選擇分類主題（可空白自動判斷）：</label><br>
      <select id="topicSelect">
        <option value="">AI 自動判斷</option>
        <option>人生成長</option>
        <option>情感故事</option>
        <option>商業洞察</option>
        <option>科技未來</option>
        <option>品牌行銷</option>
      </select><br>

      <button onclick="autoRewrite()">🚀 自動改寫</button>
      <div id="rewriteResult" style="margin-top:20px;"></div>
    </div>

    <script>
      function autoRewrite() {
        const text = document.getElementById("originalText").value;
        const topic = document.getElementById("topicSelect").value;

        if (!text.trim()) {
          alert("請先貼上文章內容");
          return;
        }

        document.getElementById("rewriteResult").innerHTML = "⏳ 改寫中，請稍候...";

        google.script.run.withSuccessHandler((res) => {
          document.getElementById("rewriteResult").innerHTML = `
            <b>🔖 類別：</b>${res.topic}<br>
            <b>📌 推薦標題：</b>${res.title}<br><br>
            <b>📝 改寫內容：</b><br><pre>${res.content}</pre>
          `;
        }).rewriteWithAI(text, topic);
      }
    </script>
  </body>
</html>
