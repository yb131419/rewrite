<!-- index.html -->
<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body { font-family: 'Segoe UI', sans-serif; padding: 20px; }
      .card { border: 1px solid #ccc; border-radius: 10px; padding: 20px; margin-bottom: 20px; background-color: #f9f9f9; }
      textarea { width: 100%; height: 120px; padding: 10px; border-radius: 6px; border: 1px solid #ddd; }
      select, button { padding: 8px; font-size: 14px; border-radius: 5px; margin-top: 10px; }
      pre { background: #efefef; padding: 10px; border-radius: 6px; white-space: pre-wrap; }
    </style>
  </head>
  <body>
    <div class="card">
      <h2>ğŸ“˜ è²¼ä¸Šæ–‡ç« è‡ªå‹•æ”¹å¯«</h2>
      <textarea id="originalText" placeholder="è«‹è²¼ä¸ŠåŸå§‹æ–‡ç« ..."></textarea><br><br>

      <label>é¸æ“‡åˆ†é¡ä¸»é¡Œï¼ˆå¯ç©ºç™½è‡ªå‹•åˆ¤æ–·ï¼‰ï¼š</label><br>
      <select id="topicSelect">
        <option value="">AI è‡ªå‹•åˆ¤æ–·</option>
        <option>äººç”Ÿæˆé•·</option>
        <option>æƒ…æ„Ÿæ•…äº‹</option>
        <option>å•†æ¥­æ´å¯Ÿ</option>
        <option>ç§‘æŠ€æœªä¾†</option>
        <option>å“ç‰Œè¡ŒéŠ·</option>
      </select><br>

      <button onclick="autoRewrite()">ğŸš€ è‡ªå‹•æ”¹å¯«</button>
      <div id="rewriteResult" style="margin-top:20px;"></div>
    </div>

    <script>
      function autoRewrite() {
        const text = document.getElementById("originalText").value;
        const topic = document.getElementById("topicSelect").value;

        if (!text.trim()) {
          alert("è«‹å…ˆè²¼ä¸Šæ–‡ç« å…§å®¹");
          return;
        }

        document.getElementById("rewriteResult").innerHTML = "â³ æ”¹å¯«ä¸­ï¼Œè«‹ç¨å€™...";

        google.script.run.withSuccessHandler((res) => {
          document.getElementById("rewriteResult").innerHTML = `
            <b>ğŸ”– é¡åˆ¥ï¼š</b>${res.topic}<br>
            <b>ğŸ“Œ æ¨è–¦æ¨™é¡Œï¼š</b>${res.title}<br><br>
            <b>ğŸ“ æ”¹å¯«å…§å®¹ï¼š</b><br><pre>${res.content}</pre>
          `;
        }).rewriteWithAI(text, topic);
      }
    </script>
  </body>
</html>
