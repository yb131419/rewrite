<!DOCTYPE html>
<html>
<head>
  <base target="_top">
</head>
<body>
  <h2>測試寫入工作表</h2>
  <textarea id="inputText" rows="5" cols="40" placeholder="輸入想寫入的文字"></textarea><br>
  <button onclick="sendToSheet()">寫入試算表</button>
  <div id="status"></div>

  <script>
    function sendToSheet() {
      const text = document.getElementById('inputText').value.trim();
      const statusDiv = document.getElementById('status');
      if (!text) {
        alert('請輸入文字');
        return;
      }
      statusDiv.textContent = '寫入中...';

      google.script.run
        .withSuccessHandler(res => {
          if (res.success) {
            statusDiv.textContent = res.message;
          } else {
            statusDiv.textContent = '錯誤：' + res.error;
          }
        })
        .withFailureHandler(err => {
          statusDiv.textContent = '呼叫失敗，請稍後再試';
          console.error('google.script.run failed:', err);
        })
        .testWriteToSheet(text);
    }
  </script>
</body>
</html>
